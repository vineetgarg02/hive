PREHOOK: query: CREATE TABLE table1(i int CHECK -i > -10,
    j int CHECK +j > 10,
    ij boolean CHECK ij IS NOT NULL,
    a int CHECK a BETWEEN i AND j,
    bb float CHECK bb IN (23.4,56,4),
    d bigint CHECK d > round(567.6) AND d < round(1000.4))
    clustered by (i) into 2 buckets stored as orc TBLPROPERTIES('transactional'='true')
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@table1
POSTHOOK: query: CREATE TABLE table1(i int CHECK -i > -10,
    j int CHECK +j > 10,
    ij boolean CHECK ij IS NOT NULL,
    a int CHECK a BETWEEN i AND j,
    bb float CHECK bb IN (23.4,56,4),
    d bigint CHECK d > round(567.6) AND d < round(1000.4))
    clustered by (i) into 2 buckets stored as orc TBLPROPERTIES('transactional'='true')
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@table1
PREHOOK: query: DESC FORMATTED table1
PREHOOK: type: DESCTABLE
PREHOOK: Input: default@table1
POSTHOOK: query: DESC FORMATTED table1
POSTHOOK: type: DESCTABLE
POSTHOOK: Input: default@table1
# col_name            	data_type           	comment             
i                   	int                 	                    
j                   	int                 	                    
ij                  	boolean             	                    
a                   	int                 	                    
bb                  	float               	                    
d                   	bigint              	                    
	 	 
# Detailed Table Information	 	 
Database:           	default             	 
#### A masked pattern was here ####
Retention:          	0                   	 
#### A masked pattern was here ####
Table Type:         	MANAGED_TABLE       	 
Table Parameters:	 	 
	transactional       	true                
	transactional_properties	default             
#### A masked pattern was here ####
	 	 
# Storage Information	 	 
SerDe Library:      	org.apache.hadoop.hive.ql.io.orc.OrcSerde	 
InputFormat:        	org.apache.hadoop.hive.ql.io.orc.OrcInputFormat	 
OutputFormat:       	org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat	 
Compressed:         	No                  	 
Num Buckets:        	2                   	 
Bucket Columns:     	[i]                 	 
Sort Columns:       	[]                  	 
Storage Desc Params:	 	 
	serialization.format	1                   
	 	 
# Constraints	 	 
	 	 
# Check Constraints	 	 
Table:              	default.table1      	 
Constraint Name:    	#### A masked pattern was here ####	 
Column Name:a       	Check Value:a BETWEEN i AND j	 
	 	 
Constraint Name:    	#### A masked pattern was here ####	 
Column Name:d       	Check Value:d > round(567.6) AND d < round(1000.4)	 
	 	 
Constraint Name:    	#### A masked pattern was here ####	 
Column Name:i       	Check Value:-i > -10	 
	 	 
Constraint Name:    	#### A masked pattern was here ####	 
Column Name:j       	Check Value:+j > 10 	 
	 	 
Constraint Name:    	#### A masked pattern was here ####	 
Column Name:ij      	Check Value:ij IS NOT NULL	 
	 	 
Constraint Name:    	#### A masked pattern was here ####	 
Column Name:bb      	Check Value:bb IN (23.4,56,4)	 
	 	 
PREHOOK: query: EXPLAIN INSERT INTO table1 values(1,100,true, 5, 23.4, 700.5)
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN INSERT INTO table1 values(1,100,true, 5, 23.4, 700.5)
POSTHOOK: type: QUERY
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-2 depends on stages: Stage-1
  Stage-0 depends on stages: Stage-2

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (CUSTOM_SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: _dummy_table
                  Row Limit Per Split: 1
                  Statistics: Num rows: 1 Data size: 10 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: array(const struct(1,100,true,5,23.4,700.5)) (type: array<struct<col1:int,col2:int,col3:boolean,col4:int,col5:decimal(3,1),col6:decimal(4,1)>>)
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 48 Basic stats: COMPLETE Column stats: COMPLETE
                    UDTF Operator
                      Statistics: Num rows: 1 Data size: 48 Basic stats: COMPLETE Column stats: COMPLETE
                      function name: inline
                      Select Operator
                        expressions: col1 (type: int), col2 (type: int), col3 (type: boolean), col4 (type: int), col5 (type: decimal(3,1)), col6 (type: decimal(4,1))
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                        Filter Operator
                          predicate: enforce_constraint((((((((- _col0) > (- 10)) is not false and (_col1 > 10) is not false) and _col2 is not null is not false) and _col3 BETWEEN _col0 AND _col1 is not false) and (_col4) IN (23.4, 56, 4) is not false) and ((_col5 > round(567.6)) and (_col5 < round(1000.4))) is not false)) (type: boolean)
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            sort order: 
                            Map-reduce partition columns: _col0 (type: int)
                            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: boolean), _col3 (type: int), _col4 (type: decimal(3,1)), _col5 (type: decimal(4,1))
            Execution mode: llap
            LLAP IO: no inputs
        Reducer 2 
            Execution mode: llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: boolean), VALUE._col3 (type: int), UDFToFloat(VALUE._col4) (type: float), UDFToLong(VALUE._col5) (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                  table:
                      input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                      output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
                      serde: org.apache.hadoop.hive.ql.io.orc.OrcSerde
                      name: default.table1
                  Write Type: INSERT

  Stage: Stage-2
    Dependency Collection

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
              output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
              serde: org.apache.hadoop.hive.ql.io.orc.OrcSerde
              name: default.table1
          Write Type: INSERT

PREHOOK: query: INSERT INTO table1 values(1,100,true, 5, 23.4, 700.5)
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Output: default@table1
POSTHOOK: query: INSERT INTO table1 values(1,100,true, 5, 23.4, 700.5)
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Output: default@table1
POSTHOOK: Lineage: table1.a SCRIPT []
POSTHOOK: Lineage: table1.bb SCRIPT []
POSTHOOK: Lineage: table1.d SCRIPT []
POSTHOOK: Lineage: table1.i SCRIPT []
POSTHOOK: Lineage: table1.ij SCRIPT []
POSTHOOK: Lineage: table1.j SCRIPT []
PREHOOK: query: SELECT * from table1
PREHOOK: type: QUERY
PREHOOK: Input: default@table1
#### A masked pattern was here ####
POSTHOOK: query: SELECT * from table1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@table1
#### A masked pattern was here ####
1	100	true	5	23.4	700
PREHOOK: query: DROP TABLE table1
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@table1
PREHOOK: Output: default@table1
POSTHOOK: query: DROP TABLE table1
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@table1
POSTHOOK: Output: default@table1
PREHOOK: query: CREATE TABLE table2(i int CHECK i + NULL > 0)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@table2
POSTHOOK: query: CREATE TABLE table2(i int CHECK i + NULL > 0)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@table2
PREHOOK: query: DESC FORMATTED table2
PREHOOK: type: DESCTABLE
PREHOOK: Input: default@table2
POSTHOOK: query: DESC FORMATTED table2
POSTHOOK: type: DESCTABLE
POSTHOOK: Input: default@table2
# col_name            	data_type           	comment             
i                   	int                 	                    
	 	 
# Detailed Table Information	 	 
Database:           	default             	 
#### A masked pattern was here ####
Retention:          	0                   	 
#### A masked pattern was here ####
Table Type:         	MANAGED_TABLE       	 
Table Parameters:	 	 
#### A masked pattern was here ####
	 	 
# Storage Information	 	 
SerDe Library:      	org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe	 
InputFormat:        	org.apache.hadoop.mapred.TextInputFormat	 
OutputFormat:       	org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat	 
Compressed:         	No                  	 
Num Buckets:        	-1                  	 
Bucket Columns:     	[]                  	 
Sort Columns:       	[]                  	 
Storage Desc Params:	 	 
	serialization.format	1                   
	 	 
# Constraints	 	 
	 	 
# Check Constraints	 	 
Table:              	default.table2      	 
Constraint Name:    	#### A masked pattern was here ####	 
Column Name:i       	Check Value:i + NULL > 0	 
	 	 
PREHOOK: query: EXPLAIN INSERT INTO table2 values(8)
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN INSERT INTO table2 values(8)
POSTHOOK: type: QUERY
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-2 depends on stages: Stage-1
  Stage-0 depends on stages: Stage-2

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: _dummy_table
                  Row Limit Per Split: 1
                  Statistics: Num rows: 1 Data size: 10 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: array(const struct(8)) (type: array<struct<col1:int>>)
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 48 Basic stats: COMPLETE Column stats: COMPLETE
                    UDTF Operator
                      Statistics: Num rows: 1 Data size: 48 Basic stats: COMPLETE Column stats: COMPLETE
                      function name: inline
                      Select Operator
                        expressions: col1 (type: int)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                        Filter Operator
                          predicate: enforce_constraint(((_col0 + null) > 0) is not false) (type: boolean)
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                          File Output Operator
                            compressed: false
                            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                            table:
                                input format: org.apache.hadoop.mapred.TextInputFormat
                                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                                name: default.table2
            Execution mode: llap
            LLAP IO: no inputs

  Stage: Stage-2
    Dependency Collection

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: default.table2

PREHOOK: query: INSERT INTO table2 values(8)
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Output: default@table2
POSTHOOK: query: INSERT INTO table2 values(8)
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Output: default@table2
POSTHOOK: Lineage: table2.i SCRIPT []
PREHOOK: query: select * from table2
PREHOOK: type: QUERY
PREHOOK: Input: default@table2
#### A masked pattern was here ####
POSTHOOK: query: select * from table2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@table2
#### A masked pattern was here ####
8
PREHOOK: query: Drop table table2
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@table2
PREHOOK: Output: default@table2
POSTHOOK: query: Drop table table2
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@table2
POSTHOOK: Output: default@table2
PREHOOK: query: CREATE FUNCTION test_udf2 AS 'org.apache.hadoop.hive.ql.udf.generic.GenericUDFTestGetJavaString'
PREHOOK: type: CREATEFUNCTION
PREHOOK: Output: database:default
PREHOOK: Output: default.test_udf2
POSTHOOK: query: CREATE FUNCTION test_udf2 AS 'org.apache.hadoop.hive.ql.udf.generic.GenericUDFTestGetJavaString'
POSTHOOK: type: CREATEFUNCTION
POSTHOOK: Output: database:default
POSTHOOK: Output: default.test_udf2
PREHOOK: query: CREATE TABLE tudf(v string CHECK test_udf2(v) <> 'vin')
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@tudf
POSTHOOK: query: CREATE TABLE tudf(v string CHECK test_udf2(v) <> 'vin')
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@tudf
PREHOOK: query: EXPLAIN INSERT INTO tudf values('function1')
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN INSERT INTO tudf values('function1')
POSTHOOK: type: QUERY
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-2 depends on stages: Stage-1
  Stage-0 depends on stages: Stage-2

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: _dummy_table
                  Row Limit Per Split: 1
                  Statistics: Num rows: 1 Data size: 10 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: array(const struct('function1')) (type: array<struct<col1:string>>)
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 48 Basic stats: COMPLETE Column stats: COMPLETE
                    UDTF Operator
                      Statistics: Num rows: 1 Data size: 48 Basic stats: COMPLETE Column stats: COMPLETE
                      function name: inline
                      Select Operator
                        expressions: col1 (type: string)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                        Filter Operator
                          predicate: enforce_constraint((GenericUDFTestGetJavaString(_col0) <> 'vin') is not false) (type: boolean)
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                          File Output Operator
                            compressed: false
                            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                            table:
                                input format: org.apache.hadoop.mapred.TextInputFormat
                                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                                name: default.tudf
            Execution mode: llap
            LLAP IO: no inputs

  Stage: Stage-2
    Dependency Collection

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: default.tudf

PREHOOK: query: Drop table tudf
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@tudf
PREHOOK: Output: default@tudf
POSTHOOK: query: Drop table tudf
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@tudf
POSTHOOK: Output: default@tudf
